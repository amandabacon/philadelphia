<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
  <head> 
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
    <title>Philadelphia :: All Reports</title>
    <script type="text/javascript" src="js/json2.js"></script>
    <script type="text/javascript" src="js/jquery-1.6.2.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.8.16.custom.min.js"></script>
    <script type="text/javascript" src="js/jquery.tablesorter.min.js"></script>
    <script type="text/javascript" src="/_utils/script/jquery.couch.js?0.9.0"></script> 
    <link type="text/css" rel="stylesheet" href="css/style.css"/>
    <link type="text/css" rel="stylesheet" href="css/jquery-ui-1.8.16.custom.css"/>
    <link type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Droid+Sans"/> 	
  </head>
  <body>
    <!-- begin header //-->
    <div id="header">
      <div id="branding">
        <h1 id="site-name">Philadelphia</h1>
      </div>
    </div>
    <br/>
    <!-- end header //-->

    <!-- begin content //-->
    <div id="content">

      <!-- begin report list //-->
      <div class="ui-widget" style="float:left;width:73%;padding-left:10px">
        <div class="ui-widget-header">
          Shift Reports
          <div id="save" style="float:right;margin-top:-2px">
            <button type="button" id="plot" class="plot" style="font-size:small" onclick="window.location.href='plot.html'">Make a Plot</button>
            <button type="button" id="new" class="new good" style="font-size:small;font-weight:bold" onclick="window.location.href='compose.html'">New</button>
          </div>
        </div>
        <div id="reportlist" class="ui-widget-content" style="font-size:small;border:none">
          <table id="reportlist_table" class="tablesorter" cellpadding=0 cellspacing=0>
            <thead>
              <th>Report ID</th>
              <th>Time Created</th>
              <th>Run Number</th>
              <th>Summary</th>
              <th>Crew</th>
            </thead>
            <tbody id="reportlist_rows"></tbody>
          </table>
        </div>
      </div>
      <!-- end report list //-->

      <!-- begin footer //-->
      <div style="font-size:xx-small;float:right;padding-right:3em">
        <dl>
          <dt><b>Philadelphia,</b></dt>
          <dd><a href="https://github.com/mastbaum/philadelphia">Source on github</a></dd>
          <dd><a href="https://github.com/mastbaum/philadelphia/issues">Report a bug</a></dd>
          <dd>&nbsp;</dd>
          <dd><a href="mailto:mastbaum@hep.upenn.edu">Andy Mastbaum</a></dd>
          <dd>The University of Pennsylvania</dd>
        </dl>
      </div>
      <!-- end footer //-->

    </div>
    <!-- end content //-->

  </body>

  <script>
    $(document).ready(function() {
      $db = $.couch.db("phila");
      $db.list("phila/reports", "phila/reports", {
        success: function(data) {
          for (i in data) {
            var id = data[i].id;
            var summary = data[i].summary;
            var run = data[i].run;
            var crew = data[i].crew;
            var d = new Date(data[i].created);
            var created = dateString(d);
            //var created = d;
            html = '<tr>' +
              '<td>' +
                '<a href="view.html?id=' + id + '">' + id.substring(id.length-8, id.length) + '</a></td>' +
              '<td>' + created + '</td>' +
              '<td>' + run + '</td>' +
              '<td>' + summary + '</td>' +
              '<td>' + crew + '</td>' +
              '</tr>';
            $("tbody#reportlist_rows").append(html);
          }  
          $("#reportlist_table").tablesorter({sortList: [[1,1]], widgets:['zebra']}); 
        }
      });
    });

    function dateString(d) {
      function pad(n){
        return n<10 ? '0'+n : n
      }
      return d.getFullYear()+'-'
      + pad(d.getMonth()+1)+'-'
      + pad(d.getDate())+' '
      + pad(d.getHours())+':'
      + pad(d.getMinutes())+':'
      + pad(d.getSeconds());
    }
  </script>

</html>

